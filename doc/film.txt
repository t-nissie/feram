=begin
= Introduction of feram

<b>A fast MD program for perovskite-type ferroelectric bulks and thin films</b>

.

Jaita Paul, <b>Takeshi Nishimatsu</b>, Yoshiyuki Kawazoe and

Umesh V. Waghmare: Phys. Rev. Lett. Vol.99 p.077601 (2007)

.

http://loto.sf.net/feram/

# Today, I will introduce you my new simulation program "feram".
# A fast Molecular Dynamics simulation program for perovskite-type ferroelectric bulks and thin films.
# feram is an abbreviation of "Ferroelectrics and Relaxor Analyzing Machine"
# or of course "Ferroelectrics Random Access Memory."
# My name is Takeshi Nishimatsu.
# You can find some details of today's talk in this paper or in this web site.





== What are ferroelectrics?
figures/ferroelectrics.jpg Properties of ferroelectrics, such as BaTiO$_3$, PbTiO$_3$, KNbO$_3$, LiNbO$_3$, LiTaO$_3$, SrTiO$_3$ and Pb(Zr$_{(1-x)}$Ti$_x$)O$_3$ (PZT). <b>feram</b> can simulate such ferroelectrics.

# As you know,
# ferroelectrics such as BaTiO3, PbTiO3, SrTiO3 and PZT
# has characteristic properties, for example,
# spontaneous polarization
# phase transition
# piezoelectric effect
# inverse piezoelectric effect.
#
# Here, I'd like to emphasize that
# without long-rage interaction and finite size effects,
# you will not see the domain structure like this.



== Monte Carlo (MC) vs. Molecular Dynamics (MD)
feram is a <b>molecular dynamics (MD)</b> program for bulk and thin-film ferroelectrics.

figures/MC-vs-MD.jpg Simulations of bulk BaTiO<sub>3</sub> with MC and MD.  Horizontal axis is temperature. Vertical axis is strain. While Monte Carlo steps do NOT have physical meaning, MD simulation steps have a physical meaning of the time evolution. Cooling and heating MD simulation can show hysteresis in temperature clearly.

# feram is a molecular dynamics program for bulk and thin-film ferroelectrics.
#
# This shows Simulations of bulk BaTiO<sub>3</sub> with MC and MD.
# Horizontal axis is temperature. Vertical axis is strain.
# Compared to old Monte Carlo simulations, MD simulation steps have a physical
# meaning of the time evolution. So, for example, Cooling and heating MD simulation
# can show hysteresis in temperature clearly.
# As you may often see in textbooks of ferroelectrics,


== Features of feram program
 * Scientific features
   * Molecular dynamics (MD) simulation based on first-principles-based effective Hamiltonian
   * $AB$O<sub>3</sub>-type perovskite ferroelectrics and relaxors
   * Uses supercell; ($AB$O<sub>3</sub>)$_N$, $N=32\times 32\times 512$ $\Rightarrow$ 2,621,440 atoms
   * Coarse-graining; reduction of the number of degree of freedom
   * Long-range dipole-dipole interaction is treated in reciprocal-space; k-locality of the force matrix
   * Applications:
     * Phase transition of bulk ferroelectrics
     * Capacitor, <b>ferroelectric thin film</b> is sandwiched between short-circuited electrodes

 * Technical features
   * Fast
     * FFTW library version 3  http://www.fftw.org/
     * Parallelized with OpenMP
   * Multi-platform
     * Linux
     * HITACHI SR11000 Super Technical Server
   * Object oriented programming (OOP) in Fortran 2003
   * GNU autotools  http://www.gnu.org/software/autoconf/
   * Free software (GPLv3) http://loto.sf.net/feram/

# The other features of feram program are:
# Its Molecular dynamics (MD) simulation is based on first-principles-based effective Hamiltonian.
# It can simulate ABO3-type perovskite ferroelectrics and relaxors
# It can use big size of supercell up to 32x32x512. It corresponds 2,621,440 atoms.
# It can do such a huge calculation because it employs some kind of Coarse-graining that
# reduces the number of degree of freedom of the system.
# and because Long-range dipole-dipole interaction is treated
# in reciprocal-space using k-locality of the force matrix
#
# Using this program, you can simulate
# Phase transition of bulk ferroelectrics and properties of
# capacitors in which ferroelectric thin film is sandwiched between short-circuited electrodes.
# Today, I will show you our study of ferroelectric thin film.
#
# This program is fast, because it uses a fast FFT library and
# it is parallelized with OpenMP.
# You can freely download feram from this site.


== Purpose of feram: ferroelectric thin-film capacitors
 * Down-sizing of non-volatile FeRAM
 * Fatigue of electrodes of capacitors
   (M. Dawber et al.: J. Phys. Condes. Matter vol.15 p.L393 (2003))
 * Hysteresis, polarization switching, dynamics of domain wall
   and their nano-size effects are not well known (Figure below).
 * <em>in situ</em> observations are difficult
$\to$ Computational simulation with "feram" program.


figures/Fong.jpg

# One of the purposes of this simulation program is to study
# the thermal properties
# of ferroelectric thin-film and its capacitors.
#
# Ferroelectric thin-film capacitors are applied in non-volatile FeRAM.
# And their down-sizing are highly demanded.
#
# Fatigue of electrodes of capacitors is a current big problem
#
# But their Hysteresis, polarization switching, dynamics of domain wall
# and their nano-size effects are not well known.
#
# This is an example of experimental study of thin films.
# Fong et al. studied PbTiO3 thin films' striped ferroelectric domain structure
# with strong X-ray. They found thickness dependence of Tc.
#
# Basically, experimental {\em in situ} observations of such dynamics are difficult.
#
# But you can do simulation with feram.





== Perovskite type ferroelectrics ABO<sub>3</sub>
King-Smith and Vanderbilt: Phys. Rev. B Vol.49 p.5828 (1994): Parametrization of coupling between soft-mode displacement and strains.

figures/perovskite-contours.jpg Coupling between atomic displacements and strains. After Hashimoto et al.: Jpn. J. Appl. Phys. Vol.43 p.6785 (2004).

# feram can simulate Perovskite type ferroelectrics which have ABO3 formula.
# In perovskite type ferroelectrics ABO$_3$, atomic displacements and strains
# are strongly coupled. This is the cubic to high temperature crystal structure of ABO$_3$.
# Unit cell has 5 atoms. So atomic displacements spans a 3x5=15-dimensional space.
# This is a 2-dimensional subspace of the 15-dimensional space......
#
# In 1994, my boss David Vanderbilt parametrized this coupling.






== Effective Hamiltonian and Coarse-graining
Simulation with a supercell; ($AB$O<sub>3</sub>)$_N$
Eq. 1
    H^{\rm eff}
    = \frac{M^*_{\rm dipole}}{2} \sum_{\bm{R},\alpha}\dot{u}_\alpha^2(\bm{R})
    + \frac{M^*_{\rm acoustic}}{2}\sum_{\bm{R},\alpha}\dot{w}_\alpha^2(\bm{R})
    + V^{\rm self}(\{\bm{u}\})+V^{\rm dpl}(\{\bm{u}\})+V^{\rm short}(\{\bm{u}\})
    + V^{\rm elas,\,homo}(\eta_1,...,\eta_6)+V^{\rm elas,\,inho}(\{\bm{w}\})
    + V^{\rm coup,\,homo}(\{\bm{u}\}, \eta_1,...,\eta_6)+V^{\rm coup,\,inho}(\{\bm{u}\}, \{\bm{w}\})
/Eq.

 * Real perovskite-like system has $15N+6$ degree of freedom
   * $N$ unit cells in supercell
   * 5 atoms per unit cell
   * Each atom can move along 3 directions
   * 6 components of strain

 * Simplified model has $6N+6$ degree of freedom
   * Define 1 dipole $Z^*\bm{u}(\bm{R})$ per unit cell
   * 1 acoustic displacement (Inhomogeneous strain) $\bm{w}(\bm{R})$ per unit cell

figures/CoarseGraining.jpg

# Using that parameters, we can construct an effective Hamiltonian for a supercell with
# N unit cells of ABO3.
#
# In the Hamiltonian, Coarse-graining is employed.
# In the other words, the number of degree of freedom is reduced.
#
# Real perovskite-like system has 15N+6 degree of freedom,
# where N is the number of unit cells in supercell,
# because each unit cell has 5 atoms, each atom can move along 3 directions,
# and there are 6 components of homogeneous strain.
#
# For Fast and Simple simulation, we reduce the number of degree of freedom to 6N+6,
# by replacing 5 atoms to 2 vectors, 1 dipole Z^*u(R) and 1 acoustic displacement
# per unit cell.
#
# We solve this Hamiltonian with Molecular Dynamics.





== Thin films sandwiched between short-circuited electrodes
figures/capacitor.jpg Ferroelectrics are sandwiched between short-circuited perfect electrodes (a) and imperfect electrodes (b). In (a) depolarization field $P_d=0$, but in (b) $P_d=4\pi P_z \frac{d}{l+d}$.

# This slide show you how ...








== Temperature dependence of polarizations of thin-film capacitors
figures/epitDEN.jpg

# These complicated figures are the calculated results for the thin-film
# capacitors. Horizontal axes are temperature and vertical axes are
# averaged u-z or sqrt of averaged u-z-square.
# Red solid line can be considered as z-component of
# polarization for heating-up simulation. Blue one is that for cooling.
#
# You can find the thickness dependent transition for heating-up simulations.
# but no transition for cooling-down simulations.
#
# It can be understood there is thermally unhoppable bistability between
# uniformly out-of-plane-polarized ferroelectric structure and
# striped ferroelectric domain structure.
#
# You can read from the average of u-z-square that
# true ferroelectric - paraelectric phase transition
# which is almost constant around 650 Kelvin.
#
# In next slide, I show the snapshot of this point structure.


== Uniformly polarized structure and striped domain structure
figures/epit-32x32-L015-D1-5.0GPa-100K.jpg
Almost uniformly polarized structure ((a) and (b))and striped domain structure ((c) and (d)) of thin-film BaTiO<sub>3</sub> capacitors of $32\times 32 \times (l=15, d=1)$. There is thermally unhoppable bistability between these two structure.

== Thiner film has finer domain structure to avoid stronger depolarization field
figures/slice32x32.jpg Horizontal slices of domain structures in capacitors of epitaxial BaTiO<sub>3</sub> thin-film with imperfect electrodes. Thiner film has finer domain structure to avoid stronger depolarization field.






== Proposal of an experiment of BaTiO<sub>3</sub> thin-film capacitor
figures/proposal2.gif (1) On SrRuO<sub>3</sub> or Pt metallic substrate, (2) grow BaTiO<sub>3</sub> thin and thick thin films, (3) cover them with the metal, (4) if you use x-ray or whatever, (5) you may observe deference of fineness in their domain structures.










== Summary
 * feram is a fast simulator for perovskite-type ferroelectric bulks and thin films
 * Molecular dynamics (MD) simulation with first-principles-based effective Hamiltonian
 * Phase transition of bulk ferroelectrics
 * Thin-film capacitor: perfect and imperfect short-circuited electrodes
   * Striped domain structure is predicted
   * An experiment of BaTiO<sub>3</sub> thin-film capacitor is proposed

== Parameters (input file)
 * King-Smith and Vanderbilt: Phys. Rev. B Vol.49 p.5828 (1994)
 * Zhong, Vanderbilt, and Rabe: Phys. Rev. B Vol.52 p.6301 (1995)

 #--- Method, Temperature, and mass ---------------
 method = 'md'
    # 'md' - Molecular Dynamics with Nose-Poincare thermostat (Canonical ensemble)
    # 'lf' - Leap Frog (Microcanonical ensemble)
    # 'mc' - Monte Carlo
 GPa = -5.0
 kelvin_start = 350
 kelvin_goal  =  50
 kelvin_step  =  -5
 mass_amu = 39.0       # Required for MD
 Q_Nose = 1.0

 #--- System geometry -----------------------------
 bulk_or_film = 'bulk'
 L = 32 32 32
 a0 =  3.94         lattice constant a0 [Angstrom]

 #--- Time step -----------------------------------
 dt = 0.002 [ps]
 n_thermalize =  40000
 n_average    =  10000
 n_coord_freq =   5000     Write a snapshot to the disk every 5000 steps

 #--- On-site (Polynomial of order 4) -------------
 P_kappa2 =    5.502  [eV/Angstrom^2] # P_4(u) = kappa2*u^2 + alpha*u^4
 P_alpha  =  110.4    [eV/Angstrom^4] #  + gamma*(u_y*u_z+u_z*u_x+u_x*u_y),
 P_gamma  = -163.1    [eV/Angstrom^4] # where u^2 = u_x^2 + u_y^2 + u_z^2

 #--- Inter-site ----------------------------------
 j = -2.648 3.894 0.898 -0.789 0.562 0.358 0.179    j(i) [eV/Angstrom^2]

 #--- Elastic Constants ---------------------------
 B11 = 126.
 B12 =  44.9
 B44 =  50.3  [eV]

 #--- Elastic Coupling ----------------------------
 B1xx = -211.   [eV/Angstrom^2]
 B1yy =  -19.3  [eV/Angstrom^2]
 B4yz =   -7.75 [eV/Angstrom^2]

 #--- Dipole --------------------------------------
 init_dipo_avg = 0.00 0.00 0.00   [Angstrom]  # Average   of initial dipole displacements
 init_dipo_dev = 0.02 0.02 0.02   [Angstrom]  # Deviation of initial dipole displacements
 Z_star       = 9.956
 epsilon_inf   = 5.24







== Forces on dipoles are calculated in the reciprocal space
figures/flow.jpg Simplified flow chart for calculating forces on dipoles. Fast Fourier transformation (FFT) and inverse FFT (IFFT) enable the rapid calculation of long-range dipole-dipole interactions.

# Time consuming part in simulation is the calculation of forces of dipoles because
# dipole-dipole interactions are long-range. ..... You can reduce computational time
# from O(N^2) to O(NlogN).







== Time evolution and fluctuation
figures/plot.epit-16x16-15-01-5.0GPa-0.01-cooling.jpg Energy versus time-step plot of a cooling simulation. You can see Nose-Poincare Hamiltonian remains zero.

# This figure shows the time steps of simulations.
# First, the system exchanges energy between the
# one particle heat bath, then it reaches the equilibrium.
# You can see Nose-Poincare Hamiltonian remains zero.






== Dielectric constant can be calculated from the fluctuation of dipoles
Eq. 1
\epsilon_{\alpha\beta}=(\epsilon_{\infty})_{\alpha\beta}+\frac{1}{\epsilon_0 V k_B T}
                       (<S_\alpha S_\beta>-<S_\alpha><S_\beta>)
/Eq.
figures/32x32xL032-D0-susceptibility.jpg Calculated dielectric constants (in-plane and out-of-plane) of epitaxially grown BaTiO$_3$ with perfect electrodes.






== ---------------------------- Relaxor ----------------------------
Relaxors Pb$B'_x$$B''_{(1-x)}$O$_3$: Pb$^{2+}$
 * Pb(Sc$_{1/2}$Nb$_{1/2}$)O$_3$ (PSN): Sc$^{3+}$, Nb$^{5+}$
 * Pb(Sc$_{1/2}$Ta$_{1/2}$)O$_3$ (PST): Sc$^{3+}$, Ta$^{5+}$
 * Pb(Mg$_{1/3}$Nb$_{2/3}$)O$_3$ (PMN:) Mg$^{2+}$, Nb$^{5+}$
 * $(1-x)$Pb(Mg$_{1/3}$Nb$_{2/3}$)O$_3$-xPbTiO$_3$ (PMN-$x$PT): Mg$^{2+}$, Nb$^{5+}$, Ti$^{4+}$
 * Pb(Mg$_{1/3}$Ta$_{2/3}$)O$_3$ (PMT): Mg$^{2+}$, Ta$^{5+}$
 * Pb(Zn$_{1/3}$Nb$_{2/3}$)O$_3$ (PZN): Zn$^{2+}$, Nb$^{5+}$
The averaged valence number of B-site ions $B'_x$ and $B''_{(1-x)}$ is $4+$.


# There are some Pb-based relaxors PbB'B''O$_3$.





== Frequency dependence of dielectric constant of relaxors
figures/TsurumiFig3.jpg After Takaaki Tsurumi, Kouji Soejima, Toshio Kamiya and Masaki Daimon: Jpn. J. Appl. Phys. Vol.33pp. 1959-1964 (1994)

# Most characteristic and still mysterious property of relaxors is 
#Eq.1
#\tan\delta=\tan()
#/Eq.






== Crystal structures of relaxors
figures/RandallBhallaFig3.jpg (a) Ordered B-site structure of $AB'_xB''_{(1-x)}$O$_3$. In the case of Pb(Sc$_{1/2}$Nb$_{1/2}$)O$_3$, Sc and Nb has the NaCl structure. In the case of Pb(Mg$_{1/3}$Nb$_{2/3}$)O$_3$, the Na-site is randomly occupied by Mg$_{1/3}$Nb$_{1/6}$ and the Cl-site is occupied by  Nb$_{1/2}$.  (b) Disordered structure. B-sites is occupied by $B'$ and $B''_{(1-x)}$ randomly. After C. A. Randall and A. S. Bhalla: Jpn. J. Appl. Phys. Vol. 29 pp.327-333 (1990).







== Local field on Pb-site
Displacement of Pb is the main source of dipole moment.
figures/TwoDoubleWells.jpg Symmetric potential around Pb at the chemically ordered region (COR). Asymmetric one at the chemically disordered region (CDR).








== Chemically ordered and disordered regions of relaxors
figures/RandallBhallaFig8.jpg The quenched sample has chemically ordered regions (&sim;100&Aring;) in a chemically disordered matrix. After C. A. Randall and A. S. Bhalla: Jpn. J. Appl. Phys. Vol. 29 pp.327-333 (1990).






== Modeling of relaxors
figures/DoubleWells.jpg Schematic illustration of modeling of relaxor. Bubble-like Chemically ordered regions (COR, red symmetric double wells) is created in a chemically disordered matrix (blue asymmetric double wells)





== Snapshot of a simulation of PSN relaxor
figures/SilviaFig1.jpg A (110) plane through the PSN simulation box representing the projected local field (arbitrary units) at each Pb site in the plane. Chemically ordered regions (approximately circular) have small approximately homogeneous fields, and chemically disordered regions have larger more varied and disordered local fields. After Tinte, Burton, Cockayne and Waghmare: Phys. Rev. Lett. Vol.97 p.137601 (2006).






== Susceptibility tensor
Now you can calculate $\bm{S}(\bm{R},t)$ in some periods (1-100 ns) with feram.

Susceptibility tensor $\chi(\bm{R}-\bm{R}',t-t')$
Eq. (Real space)
\bm{S}(\bm{R},t) = \sum_{\bm{R}'}\int dt' \chi(\bm{R}-\bm{R}',t-t')\,\mathscr{E}(\bm{R}',t')
/Eq.
where $\bm{S}(\bm{R},t)=Z^* \bm{u}(\bm{R},t)$ and $\mathscr{E}(\bm{R}',t')$ is external electric field.
Its Fourier transformation
Eq. (q space)
\bm{S}(\bm{q},\omega) = \chi(\bm{q},\omega)\,\mathscr{E}(\bm{q},\omega) .
/Eq.
Using the fluctuation-dissipation theorem,
Eq. (The fluctuation-dissipation theorem)
{\rm Im} \chi_{\alpha\beta}(\bm{q},\omega) = \frac{1}{2k_BT}\int_{-\infty}^{\infty}dt
                            <S_\alpha(-\bm{q},0) \,\, S_\beta(\bm{q},t)> e^{-i\omega t}
/Eq.
Then, with Kramers-Kronig relation,
Eq. (Kramers-Kronig relation)
{\rm Re} \chi_{\alpha\beta}(\bm{q},\omega) = ...
/Eq.


# If you apply external electric field at site R' at time t', dopole at R,t sespinses
# through this equation with real-space-and-time usceptibility tensor chi(R-R',t-t').
# You can simplify it by Fourier transformation and get q-omega expression.
# And then, if you apply the fluctuation-dissipation theorem to it, you may get
# the imaginary part of chi. Then with Kramers-Kronig relation, you can get the real part.
#
# G. L. Squires: Introduction to the Theory of Thermal Neutron Scattering (Dover Publications, 1996).




== Estimation of computational time
32x32x32 unit cells, $\Delta t = 2$ fs, [one dual core 1.8GHz x86_64] or [SR11000 1 node = 16 cores]

1THz, $T=1\,$ps,            500 steps,  54 sec  or 8.4 sec.

1GHz, $T=1\,$ns,        500,000 steps, 900 min. or 140 min.

1MHz, $T=1\mu$s,    500,000,000 steps, 620 days or  97 days

So, I am planning to calculate and compare $\chi_{\alpha\beta}(q,\omega)$ for $\omega/(2\pi)$ = 10M ... 10GHz.

=end
#
# for ulmul.rb
#
require 'ulmul'
u=Ulmul.new(1..0)
u.subs_rules << [/(\S*\/?\.(jpg|gif))\s*(.*)$/, '<div class="figure">
  <img src="\1" alt="\1" />
  <div class="caption">
    \3
  </div>
</div>']

u.parse(ARGF)
puts u.html(["feram-presentation.css"],["slidy.js"],"Takeshi Nishimatsu")

# Local variables:
#   mode: RD
#   compile-command: "ruby -I .. film.txt film.txt > film.xhtml"
# End:
